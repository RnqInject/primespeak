<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>kOmet.space | –ß–∏—Ç—ã –∏ DLC</title>
    <style>
        :root {
            --bg: #0a0a0a;
            --card: #111111;
            --border: #222222;
            --text: #ffffff;
            --text-secondary: #888888;
            --primary: #3b82f6;
            --green: #10b981;
            --red: #ef4444;
            --orange: #f59e0b;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }

        body {
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            padding-bottom: 70px;
        }

        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--card);
            border-top: 1px solid var(--border);
            display: flex;
            padding: 10px 0;
            z-index: 1000;
        }

        .nav-item {
            flex: 1;
            text-align: center;
            padding: 8px 0;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 12px;
        }

        .nav-item.active {
            color: var(--primary);
        }

        .admin-badge {
            background: var(--orange);
            color: black;
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 10px;
            margin-left: 5px;
        }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä */
        .container {
            padding: 20px;
            max-width: 500px;
            margin: 0 auto;
        }

        /* –ö–∞—Ä—Ç–æ—á–∫–∏ */
        .card {
            background: var(--card);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid var(--border);
        }

        /* –ö–Ω–æ–ø–∫–∏ */
        .btn {
            display: block;
            width: 100%;
            padding: 14px;
            border-radius: 10px;
            border: none;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            text-align: center;
            text-decoration: none;
            margin-bottom: 10px;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-success {
            background: var(--green);
            color: white;
        }

        .btn-outline {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text);
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 14px;
            width: auto;
        }

        /* –§–æ—Ä–º—ã */
        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-secondary);
        }

        .form-input, .form-textarea, .form-select {
            width: 100%;
            padding: 12px;
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text);
            font-size: 16px;
        }

        .form-input:focus, .form-textarea:focus, .form-select:focus {
            outline: none;
            border-color: var(--primary);
        }

        /* –§–∞–π–ª –∑–∞–≥—Ä—É–∑–∫–∞ */
        .file-upload {
            border: 2px dashed var(--border);
            border-radius: 8px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            margin-bottom: 20px;
        }

        .file-upload:hover {
            border-color: var(--primary);
        }

        /* –ò–≥—Ä—ã */
        .games-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 20px 0;
        }

        .game-card {
            background: var(--card);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            border: 1px solid var(--border);
            cursor: pointer;
        }

        .game-card:hover {
            border-color: var(--primary);
        }

        .game-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }

        .game-name {
            font-size: 12px;
            color: var(--text);
        }

        /* –ú–æ–¥–∞–ª–∫–∏ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            z-index: 1001;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--card);
            border-radius: 12px;
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-body {
            padding: 20px;
        }

        /* –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å */
        .admin-panel {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 999;
        }

        /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--card);
            border-radius: 8px;
            padding: 15px 20px;
            border-left: 4px solid var(--primary);
            z-index: 1002;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }

        /* –ë–∞–ª–∞–Ω—Å */
        .balance {
            background: linear-gradient(135deg, #1a1a1a, #111);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            border: 1px solid var(--border);
        }

        .balance-amount {
            font-size: 32px;
            font-weight: 700;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <!-- –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å (–µ—Å–ª–∏ –∞–¥–º–∏–Ω) -->
    <div class="admin-panel" id="adminPanel" style="display: none;">
        <button class="btn btn-small" onclick="openAdminModal()">üëë –ê–¥–º–∏–Ω</button>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <div class="container" id="mainContent">
        <!-- –°—Ç—Ä–∞–Ω–∏—Ü—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Å—é–¥–∞ -->
    </div>

    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
    <nav class="bottom-nav">
        <a href="#" class="nav-item active" onclick="showPage('home')">–ì–ª–∞–≤–Ω–∞—è</a>
        <a href="#" class="nav-item" onclick="showPage('catalog')">–ö–∞—Ç–∞–ª–æ–≥</a>
        <a href="#" class="nav-item" onclick="showPage('keys')">–ö–ª—é—á–∏</a>
        <a href="#" class="nav-item" onclick="showPage('invite')">–ü—Ä–∏–≥–ª.</a>
        <a href="#" class="nav-item" onclick="showPage('kometa')">–ö–æ–º–µ—Ç–∞</a>
    </nav>

    <!-- –ú–æ–¥–∞–ª–∫–∞ –≤—Ö–æ–¥–∞ -->
    <div class="modal" id="authModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–í—Ö–æ–¥</h3>
                <button onclick="closeModal('authModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-input" id="loginEmail" placeholder="nurislamovradmir9@gmail.com">
                </div>
                <div class="form-group">
                    <label class="form-label">–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" class="form-input" id="loginPassword" placeholder="makson555777">
                </div>
                <button class="btn btn-primary" onclick="login()">–í–æ–π—Ç–∏</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª–∫–∞ –∞–¥–º–∏–Ω–∞ -->
    <div class="modal" id="adminModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üëë –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</h3>
                <button onclick="closeModal('adminModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                    <button class="btn btn-small" onclick="showAdminTab('games')">–ò–≥—Ä—ã</button>
                    <button class="btn btn-small" onclick="showAdminTab('files')">–§–∞–π–ª—ã</button>
                    <button class="btn btn-small" onclick="showAdminTab('payments')">–ü–ª–∞—Ç–µ–∂–∏</button>
                </div>

                <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–∞–º–∏ -->
                <div id="adminGamesTab" class="admin-tab">
                    <h4 style="margin-bottom: 15px;">–î–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä—É</h4>
                    <div class="form-group">
                        <input type="text" id="newGameName" class="form-input" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∏–≥—Ä—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä: Standoff 2)">
                    </div>
                    <div class="form-group">
                        <input type="text" id="newGameIcon" class="form-input" placeholder="–ò–∫–æ–Ω–∫–∞ (—ç–º–æ–¥–∑–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä: üî´)">
                    </div>
                    <button class="btn btn-primary" onclick="addNewGame()">–î–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä—É</button>

                    <h4 style="margin: 30px 0 15px;">–î–æ–±–∞–≤–∏—Ç—å DLC/–ß–∏—Ç</h4>
                    <div class="form-group">
                        <select id="dlcGameSelect" class="form-select" onchange="updateDlcGameInfo()">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä—É</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <input type="text" id="dlcName" class="form-input" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ DLC/–ß–∏—Ç–∞">
                    </div>
                    <div class="form-group">
                        <textarea id="dlcDescription" class="form-textarea" rows="3" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ"></textarea>
                    </div>
                    <div class="form-group">
                        <input type="number" id="dlcPrice" class="form-input" placeholder="–¶–µ–Ω–∞ (‚ÇΩ)" value="299">
                    </div>
                    <div class="form-group">
                        <input type="text" id="dlcDuration" class="form-input" placeholder="–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä: 30 –¥–Ω–µ–π)">
                    </div>
                    <button class="btn btn-success" onclick="addNewDlc()">–î–æ–±–∞–≤–∏—Ç—å DLC</button>
                </div>

                <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞–º–∏ -->
                <div id="adminFilesTab" class="admin-tab" style="display: none;">
                    <h4 style="margin-bottom: 15px;">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª –¥–ª—è –∏–≥—Ä—ã</h4>
                    <div class="form-group">
                        <select id="fileGameSelect" class="form-select">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä—É</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <select id="fileDlcSelect" class="form-select">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ DLC</option>
                        </select>
                    </div>
                    <div class="file-upload" onclick="document.getElementById('fileInput').click()">
                        üìé –ù–∞–∂–º–∏—Ç–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞ (APK, EXE, ZIP)
                        <input type="file" id="fileInput" style="display: none;" onchange="handleFileUpload(event)">
                    </div>
                    <div id="fileInfo"></div>
                    <button class="btn btn-primary" onclick="uploadGameFile()">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª</button>
                </div>

                <!-- –ü–ª–∞—Ç–µ–∂–∏ -->
                <div id="adminPaymentsTab" class="admin-tab" style="display: none;">
                    <h4 style="margin-bottom: 15px;">–ó–∞—è–≤–∫–∏ –Ω–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ</h4>
                    <div id="paymentsList"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª–∫–∞ –ø–æ–∫—É–ø–∫–∏ -->
    <div class="modal" id="purchaseModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="purchaseTitle">–ü–æ–∫—É–ø–∫–∞</h3>
                <button onclick="closeModal('purchaseModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div id="purchaseContent"></div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª–∫–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è -->
    <div class="modal" id="depositModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞</h3>
                <button onclick="closeModal('depositModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="balance">
                    <div style="color: var(--text-secondary);">–í–∞—à –±–∞–ª–∞–Ω—Å</div>
                    <div class="balance-amount" id="currentBalance">0 ‚ÇΩ</div>
                </div>
                <div style="margin: 20px 0; padding: 15px; background: rgba(0,0,0,0.3); border-radius: 8px;">
                    <h4 style="margin-bottom: 10px;">–†–µ–∫–≤–∏–∑–∏—Ç—ã:</h4>
                    <p><strong>–¢–∏–Ω—å–∫–æ—Ñ—Ñ:</strong> 2200 7010 2813 9613</p>
                    <p><strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> +7 (993) 091-04-11</p>
                    <p style="color: var(--text-secondary); font-size: 14px; margin-top: 10px;">
                        –ü–æ—Å–ª–µ –ø–µ—Ä–µ–≤–æ–¥–∞ –ø—Ä–∏—à–ª–∏—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç –≤ Telegram
                    </p>
                </div>
                <button class="btn btn-primary" onclick="submitDeposit()">–Ø –ø–µ—Ä–µ–≤–µ–ª, –∂–¥—É –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è</button>
            </div>
        </div>
    </div>

    <script>
        // ====================== –î–ê–ù–ù–´–ï ======================
        let currentUser = null;
        let currentPage = 'home';
        let selectedGame = null;
        let selectedDlc = null;
        let uploadedFile = null;

        // –ò–≥—Ä—ã (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –ø—É—Å—Ç–æ, –∞–¥–º–∏–Ω –¥–æ–±–∞–≤–ª—è–µ—Ç)
        let games = JSON.parse(localStorage.getItem('komet_games')) || [];
        let dlcProducts = JSON.parse(localStorage.getItem('komet_dlc')) || {};

        // –ê–¥–º–∏–Ω –∞–∫–∫–∞—É–Ω—Ç
        const ADMIN_EMAIL = 'nurislamovradmir9@gmail.com';
        const ADMIN_PASSWORD = 'makson555777';

        // ====================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ======================
        document.addEventListener('DOMContentLoaded', function() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const savedUser = localStorage.getItem('komet_user');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                updateUI();
            }

            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –µ—Å–ª–∏ –ø—É—Å—Ç–æ
            loadInitialData();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≥–ª–∞–≤–Ω—É—é
            showPage('home');
        });

        function loadInitialData() {
            if (games.length === 0) {
                // –î–æ–±–∞–≤–ª—è–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–≥—Ä –¥–ª—è –ø—Ä–∏–º–µ—Ä–∞
                games = [
                    { id: 1, name: 'Standoff 2', icon: 'üî´' },
                    { id: 2, name: 'PUBG Mobile', icon: 'üéØ' },
                    { id: 3, name: 'Free Fire', icon: 'üî•' }
                ];
                localStorage.setItem('komet_games', JSON.stringify(games));
            }

            if (Object.keys(dlcProducts).length === 0) {
                // –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π DLC
                dlcProducts = {
                    1: [ // –î–ª—è Standoff 2
                        {
                            id: 1,
                            gameId: 1,
                            name: 'Premium –ß–∏—Ç',
                            description: '–ê–∏–º–±–æ—Ç, ESP, –≤–∞–ª–ª—Ö–∞–∫',
                            price: 299,
                            duration: '30 –¥–Ω–µ–π',
                            fileUrl: null,
                            fileName: null
                        }
                    ]
                };
                localStorage.setItem('komet_dlc', JSON.stringify(dlcProducts));
            }
        }

        // ====================== –°–¢–†–ê–ù–ò–¶–´ ======================
        function showPage(page) {
            currentPage = page;
            const content = document.getElementById('mainContent');

            // –û–±–Ω–æ–≤–ª—è–µ–º –Ω–∞–≤–∏–≥–∞—Ü–∏—é
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector(`.nav-item[onclick*="${page}"]`).classList.add('active');

            switch(page) {
                case 'home':
                    content.innerHTML = getHomePage();
                    break;
                case 'catalog':
                    content.innerHTML = getCatalogPage();
                    break;
                case 'keys':
                    content.innerHTML = getKeysPage();
                    break;
                case 'invite':
                    content.innerHTML = getInvitePage();
                    break;
                case 'kometa':
                    content.innerHTML = getKometaPage();
                    break;
            }
        }

        function getHomePage() {
            return `
                <div style="text-align: center; padding: 40px 20px;">
                    <h1 style="font-size: 28px; margin-bottom: 10px;">–ö–∞—Ç–∞–ª–æ–≥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π</h1>
                    <p style="color: var(--text-secondary); margin-bottom: 30px;">
                        –û–±—à–∏—Ä–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥ –∏–≥—Ä–æ–≤—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–∏ –ª—é–±—ã—Ö ImGUI –ø–æ –∫–ª—é—á —Å–∏—Å—Ç–µ–º–µ
                    </p>
                    <button class="btn btn-primary" onclick="showPage('catalog')">
                        –ù–∞—á–∞—Ç—å
                    </button>
                </div>
            `;
        }

        function getCatalogPage() {
            return `
                <div style="padding: 20px 0;">
                    <h1 style="font-size: 24px; margin-bottom: 20px;">DLC –ù–ê –ú–û–ë–ò–õ–¨–ù–´–ï –ò–ì–†–´</h1>
                    
                    <div class="games-grid">
                        ${games.map(game => `
                            <div class="game-card" onclick="showGamePage(${game.id})">
                                <div class="game-icon">${game.icon}</div>
                                <div class="game-name">${game.name}</div>
                            </div>
                        `).join('')}
                    </div>

                    ${currentUser?.isAdmin ? `
                        <button class="btn btn-outline" onclick="openAdminModal()">
                            üëë –î–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä—É
                        </button>
                    ` : ''}
                </div>
            `;
        }

        function showGamePage(gameId) {
            const game = games.find(g => g.id === gameId);
            if (!game) return;

            const dlcList = dlcProducts[gameId] || [];

            const content = document.getElementById('mainContent');
            content.innerHTML = `
                <div style="padding: 20px 0;">
                    <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 20px;">
                        <div class="game-icon" style="font-size: 32px;">${game.icon}</div>
                        <div>
                            <h2 style="font-size: 20px;">${game.name}</h2>
                            <div style="color: var(--text-secondary);">kOmet developers</div>
                        </div>
                    </div>

                    ${dlcList.length > 0 ? `
                        <h3 style="margin-bottom: 15px;">–î–æ—Å—Ç—É–ø–Ω—ã–µ DLC/–ß–∏—Ç—ã:</h3>
                        ${dlcList.map(dlc => `
                            <div class="card">
                                <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px;">
                                    <div>
                                        <div style="font-weight: 600; margin-bottom: 5px;">${dlc.name}</div>
                                        <div style="color: var(--text-secondary); font-size: 14px;">${dlc.description}</div>
                                    </div>
                                    <div style="color: var(--green); font-weight: 700;">${dlc.price} ‚ÇΩ</div>
                                </div>
                                <div style="display: flex; gap: 10px; margin-top: 15px;">
                                    <button class="btn btn-primary" style="flex: 1;" onclick="openPurchaseModal(${game.id}, ${dlc.id})">
                                        –ö—É–ø–∏—Ç—å
                                    </button>
                                    ${currentUser?.isAdmin && !dlc.fileUrl ? `
                                        <button class="btn btn-outline btn-small" onclick="prepareFileUpload(${game.id}, ${dlc.id})">
                                            üìé –§–∞–π–ª
                                        </button>
                                    ` : ''}
                                </div>
                                ${dlc.fileUrl ? `
                                    <div style="margin-top: 10px; color: var(--green); font-size: 14px;">
                                        ‚úÖ –§–∞–π–ª –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
                                    </div>
                                ` : ''}
                            </div>
                        `).join('')}
                    ` : `
                        <div class="card" style="text-align: center;">
                            <div style="color: var(--text-secondary); margin-bottom: 15px;">
                                –î–ª—è —ç—Ç–æ–π –∏–≥—Ä—ã –ø–æ–∫–∞ –Ω–µ—Ç DLC/—á–∏—Ç–æ–≤
                            </div>
                            ${currentUser?.isAdmin ? `
                                <button class="btn btn-primary" onclick="openAdminModal()">
                                    üëë –î–æ–±–∞–≤–∏—Ç—å DLC
                                </button>
                            ` : ''}
                        </div>
                    `}

                    ${currentUser?.isAdmin ? `
                        <button class="btn btn-outline" onclick="openAdminModal()" style="margin-top: 20px;">
                            üëë –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–π
                        </button>
                    ` : ''}
                </div>
            `;
        }

        function openPurchaseModal(gameId, dlcId) {
            if (!currentUser) {
                openAuthModal();
                return;
            }

            const game = games.find(g => g.id === gameId);
            const dlc = (dlcProducts[gameId] || []).find(d => d.id === dlcId);

            if (!game || !dlc) return;

            selectedGame = game;
            selectedDlc = dlc;

            document.getElementById('purchaseTitle').textContent = `–ü–æ–∫—É–ø–∫–∞: ${dlc.name}`;
            document.getElementById('purchaseContent').innerHTML = `
                <div style="margin-bottom: 20px;">
                    <div style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 8px; margin-bottom: 20px; font-size: 14px;">
                        –ü—Ä–∏–æ–±—Ä–µ—Ç–∞—è –¥–∞–Ω–Ω—ã–π –∫–ª—é—á –≤—ã —Å–æ–≥–ª–∞—à–∞–µ—Ç–µ—Å—å —Å —Ä–∏—Å–∫–∞–º–∏. –ü–æ –≤—Å–µ–º –≤–æ–ø—Ä–æ—Å–∞–º –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –∫ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—é https://t.me/kometspace
                    </div>
                    
                    <div class="card" style="background: rgba(59, 130, 246, 0.1);">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                            <div>
                                <div style="font-weight: 600;">${dlc.name}</div>
                                <div style="color: var(--text-secondary); font-size: 14px;">${dlc.duration}</div>
                            </div>
                            <div style="font-size: 24px; font-weight: 700; color: var(--green);">${dlc.price} ‚ÇΩ</div>
                        </div>
                        <div style="color: var(--text-secondary);">${dlc.description}</div>
                    </div>

                    <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--border);">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 20px; font-size: 18px;">
                            <span>–ö –æ–ø–ª–∞—Ç–µ:</span>
                            <span style="font-weight: 700;">${dlc.price} ‚ÇΩ</span>
                        </div>

                        ${currentUser.balance >= dlc.price ? `
                            <button class="btn btn-success" onclick="processPurchase()">
                                üí≥ –ö—É–ø–∏—Ç—å –∑–∞ ${dlc.price} ‚ÇΩ
                            </button>
                        ` : `
                            <div style="text-align: center;">
                                <div style="color: var(--red); margin-bottom: 15px;">
                                    ‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤! –ù—É–∂–Ω–æ –µ—â–µ ${dlc.price - currentUser.balance} ‚ÇΩ
                                </div>
                                <button class="btn btn-primary" onclick="openDepositModal()">
                                    üí∞ –ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å
                                </button>
                            </div>
                        `}
                    </div>
                </div>
            `;

            document.getElementById('purchaseModal').classList.add('active');
        }

        function getKeysPage() {
            const purchases = JSON.parse(localStorage.getItem('komet_purchases')) || [];
            const userPurchases = purchases.filter(p => p.userId === currentUser?.id);

            return `
                <div style="padding: 20px 0;">
                    <div class="card">
                        <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 20px;">
                            <div style="width: 50px; height: 50px; background: var(--primary); border-radius: 25px; display: flex; align-items: center; justify-content: center; font-weight: bold;">
                                ${currentUser?.username?.charAt(0) || 'U'}
                            </div>
                            <div>
                                <div style="font-weight: 600;">@${currentUser?.username || 'User'}</div>
                                <div style="color: var(--text-secondary);">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞–±–∏–Ω–µ—Ç–æ–º</div>
                            </div>
                        </div>

                        <div class="balance">
                            <div style="color: var(--text-secondary);">–ë–∞–ª–∞–Ω—Å</div>
                            <div class="balance-amount">${currentUser?.balance || 0} ‚ÇΩ</div>
                            <button class="btn btn-primary" onclick="openDepositModal()">
                                –ü–æ–ø–æ–ª–Ω–∏—Ç—å
                            </button>
                        </div>
                    </div>

                    <h2 style="margin: 30px 0 15px;">–ú–æ–∏ –∫–ª—é—á–∏ –∏ —Ñ–∞–π–ª—ã</h2>

                    ${userPurchases.length === 0 ? `
                        <div class="card" style="text-align: center;">
                            <div style="color: var(--text-secondary); padding: 30px;">
                                –£ –≤–∞—Å –µ—â–µ –Ω–µ—Ç –ø–æ–∫—É–ø–æ–∫
                            </div>
                        </div>
                    ` : userPurchases.map(purchase => {
                        const game = games.find(g => g.id === purchase.gameId);
                        const dlc = (dlcProducts[purchase.gameId] || []).find(d => d.id === purchase.dlcId);
                        
                        return `
                            <div class="card">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                    <div>
                                        <div style="font-weight: 600;">${purchase.gameName}</div>
                                        <div style="color: var(--text-secondary); font-size: 14px;">${purchase.dlcName}</div>
                                    </div>
                                    <div style="color: var(--green);">${purchase.price} ‚ÇΩ</div>
                                </div>
                                
                                <div style="background: rgba(0,0,0,0.3); padding: 10px; border-radius: 8px; font-family: monospace; margin-bottom: 10px; word-break: break-all;">
                                    üîë ${purchase.key}
                                </div>
                                
                                <div style="display: flex; gap: 10px;">
                                    <button class="btn btn-outline btn-small" onclick="copyKey('${purchase.key}')">
                                        –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–ª—é—á
                                    </button>
                                    
                                    ${purchase.fileUrl ? `
                                        <button class="btn btn-primary btn-small" onclick="downloadFile('${purchase.fileUrl}', '${purchase.fileName}')">
                                            üì• –°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª
                                        </button>
                                    ` : `
                                        <button class="btn btn-outline btn-small" disabled>
                                            ‚è≥ –§–∞–π–ª –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω
                                        </button>
                                    `}
                                </div>
                                
                                <div style="color: var(--text-secondary); font-size: 12px; margin-top: 10px;">
                                    –ö—É–ø–ª–µ–Ω–æ: ${new Date(purchase.date).toLocaleDateString('ru-RU')}
                                </div>
                            </div>
                        `;
                    }).join('')}
                </div>
            `;
        }

        function getInvitePage() {
            return `
                <div style="padding: 40px 20px; text-align: center;">
                    <div style="font-size: 24px; margin-bottom: 10px;">üéÅ</div>
                    <h2 style="margin-bottom: 10px;">–ü—Ä–∏–≥–ª–∞—Å–∏ –¥—Ä—É–∑–µ–π</h2>
                    <p style="color: var(--text-secondary); margin-bottom: 30px;">
                        –ü–æ–ª—É—á–∞–π 10% –æ—Ç –ø–æ–∫—É–ø–æ–∫ –¥—Ä—É–∑–µ–π
                    </p>
                    
                    <div class="card">
                        <div style="color: var(--text-secondary); margin-bottom: 10px;">–í–∞—à–∞ —Å—Å—ã–ª–∫–∞:</div>
                        <div style="background: rgba(0,0,0,0.3); padding: 12px; border-radius: 8px; font-family: monospace; margin-bottom: 15px;">
                            https://k0met.space/ref/${currentUser?.id || 'user'}
                        </div>
                        <button class="btn btn-primary" onclick="copyRefLink()">
                            –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É
                        </button>
                    </div>
                </div>
            `;
        }

        function getKometaPage() {
            return `
                <div style="padding: 40px 20px; text-align: center;">
                    <div style="font-size: 32px; margin-bottom: 20px;">üöÄ</div>
                    <h2 style="margin-bottom: 10px;">–ö–æ–º–µ—Ç–∞</h2>
                    <p style="color: var(--text-secondary); margin-bottom: 30px;">
                        –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
                    </p>
                    
                    <div class="card">
                        <div style="text-align: left; margin-bottom: 20px;">
                            <div style="color: var(--text-secondary); margin-bottom: 5px;">Email</div>
                            <div style="font-weight: 600;">${currentUser?.email || '–ù–µ —É–∫–∞–∑–∞–Ω'}</div>
                        </div>
                        
                        <div style="text-align: left; margin-bottom: 20px;">
                            <div style="color: var(--text-secondary); margin-bottom: 5px;">–ë–∞–ª–∞–Ω—Å</div>
                            <div style="font-size: 24px; font-weight: 700;">${currentUser?.balance || 0} ‚ÇΩ</div>
                        </div>
                        
                        ${currentUser?.isAdmin ? `
                            <button class="btn btn-primary" onclick="openAdminModal()" style="margin-bottom: 10px;">
                                üëë –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å
                            </button>
                        ` : ''}
                        
                        <button class="btn btn-outline" onclick="logout()">
                            –í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞
                        </button>
                    </div>
                    
                    <div style="color: var(--text-secondary); font-family: monospace; margin-top: 30px;">
                        kOmet.space
                    </div>
                </div>
            `;
        }

        // ====================== –ê–î–ú–ò–ù –§–£–ù–ö–¶–ò–ò ======================
        function openAdminModal() {
            if (!currentUser || !currentUser.isAdmin) {
                showNotification('error', '–¢—Ä–µ–±—É—é—Ç—Å—è –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞');
                return;
            }

            // –ó–∞–ø–æ–ª–Ω—è–µ–º —Å–ø–∏—Å–∫–∏ –∏–≥—Ä
            const gameSelect = document.getElementById('dlcGameSelect');
            const fileGameSelect = document.getElementById('fileGameSelect');
            
            gameSelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä—É</option>';
            fileGameSelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä—É</option>';
            
            games.forEach(game => {
                gameSelect.innerHTML += `<option value="${game.id}">${game.name}</option>`;
                fileGameSelect.innerHTML += `<option value="${game.id}">${game.name}</option>`;
            });

            document.getElementById('adminModal').classList.add('active');
            showAdminTab('games');
        }

        function showAdminTab(tab) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
            document.querySelectorAll('.admin-tab').forEach(t => t.style.display = 'none');
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é
            document.getElementById(`admin${tab.charAt(0).toUpperCase() + tab.slice(1)}Tab`).style.display = 'block';
        }

        function addNewGame() {
            const name = document.getElementById('newGameName').value;
            const icon = document.getElementById('newGameIcon').value;

            if (!name || !icon) {
                showNotification('error', '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ –∏–∫–æ–Ω–∫—É');
                return;
            }

            const newGame = {
                id: Date.now(),
                name: name,
                icon: icon
            };

            games.push(newGame);
            localStorage.setItem('komet_games', JSON.stringify(games));

            document.getElementById('newGameName').value = '';
            document.getElementById('newGameIcon').value = '';

            showNotification('success', `–ò–≥—Ä–∞ "${name}" –¥–æ–±–∞–≤–ª–µ–Ω–∞!`);
            showPage('catalog');
        }

        function updateDlcGameInfo() {
            const gameId = document.getElementById('dlcGameSelect').value;
            if (!gameId) return;

            const game = games.find(g => g.id == gameId);
            if (game) {
                document.getElementById('dlcName').placeholder = `–ù–∞–∑–≤–∞–Ω–∏–µ –¥–ª—è ${game.name}`;
            }
        }

        function addNewDlc() {
            const gameId = document.getElementById('dlcGameSelect').value;
            const name = document.getElementById('dlcName').value;
            const description = document.getElementById('dlcDescription').value;
            const price = parseInt(document.getElementById('dlcPrice').value);
            const duration = document.getElementById('dlcDuration').value;

            if (!gameId || !name || !price) {
                showNotification('error', '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è');
                return;
            }

            const game = games.find(g => g.id == gameId);
            if (!game) return;

            const newDlc = {
                id: Date.now(),
                gameId: parseInt(gameId),
                name: name,
                description: description || '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç',
                price: price,
                duration: duration || '30 –¥–Ω–µ–π',
                fileUrl: null,
                fileName: null
            };

            // –î–æ–±–∞–≤–ª—è–µ–º DLC –≤ —Å–ø–∏—Å–æ–∫
            if (!dlcProducts[gameId]) {
                dlcProducts[gameId] = [];
            }
            dlcProducts[gameId].push(newDlc);
            localStorage.setItem('komet_dlc', JSON.stringify(dlcProducts));

            // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
            document.getElementById('dlcName').value = '';
            document.getElementById('dlcDescription').value = '';
            document.getElementById('dlcPrice').value = '299';
            document.getElementById('dlcDuration').value = '';

            showNotification('success', `DLC "${name}" –¥–ª—è "${game.name}" –¥–æ–±–∞–≤–ª–µ–Ω!`);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–≥—Ä—É
            showGamePage(gameId);
        }

        function prepareFileUpload(gameId, dlcId) {
            document.getElementById('fileGameSelect').value = gameId;
            updateFileDlcSelect(gameId);
            document.getElementById('fileDlcSelect').value = dlcId;
            
            showAdminTab('files');
        }

        function updateFileDlcSelect(gameId) {
            const select = document.getElementById('fileDlcSelect');
            select.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ DLC</option>';
            
            const dlcList = dlcProducts[gameId] || [];
            dlcList.forEach(dlc => {
                select.innerHTML += `<option value="${dlc.id}">${dlc.name}</option>`;
            });
        }

        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            uploadedFile = file;
            
            document.getElementById('fileInfo').innerHTML = `
                <div style="background: rgba(0,0,0,0.3); padding: 10px; border-radius: 8px; margin-top: 10px;">
                    <div style="font-weight: 600;">${file.name}</div>
                    <div style="color: var(--text-secondary); font-size: 14px;">
                        –†–∞–∑–º–µ—Ä: ${(file.size / 1024 / 1024).toFixed(2)} MB
                    </div>
                </div>
            `;
        }

        function uploadGameFile() {
            const gameId = document.getElementById('fileGameSelect').value;
            const dlcId = document.getElementById('fileDlcSelect').value;

            if (!gameId || !dlcId || !uploadedFile) {
                showNotification('error', '–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä—É, DLC –∏ —Ñ–∞–π–ª');
                return;
            }

            const game = games.find(g => g.id == gameId);
            const dlc = (dlcProducts[gameId] || []).find(d => d.id == dlcId);

            if (!game || !dlc) {
                showNotification('error', '–ù–µ –Ω–∞–π–¥–µ–Ω DLC');
                return;
            }

            // –ß–∏—Ç–∞–µ–º —Ñ–∞–π–ª –∫–∞–∫ base64
            const reader = new FileReader();
            reader.onload = function(e) {
                // –û–±–Ω–æ–≤–ª—è–µ–º DLC —Å —Ñ–∞–π–ª–æ–º
                const dlcIndex = dlcProducts[gameId].findIndex(d => d.id == dlcId);
                if (dlcIndex !== -1) {
                    dlcProducts[gameId][dlcIndex].fileUrl = e.target.result;
                    dlcProducts[gameId][dlcIndex].fileName = uploadedFile.name;
                    
                    localStorage.setItem('komet_dlc', JSON.stringify(dlcProducts));
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–∫—É–ø–∫–∏ —Å —ç—Ç–∏–º DLC
                    const purchases = JSON.parse(localStorage.getItem('komet_purchases')) || [];
                    purchases.forEach(p => {
                        if (p.gameId == gameId && p.dlcId == dlcId) {
                            p.fileUrl = e.target.result;
                            p.fileName = uploadedFile.name;
                        }
                    });
                    localStorage.setItem('komet_purchases', JSON.stringify(purchases));

                    showNotification('success', `–§–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω –¥–ª—è "${dlc.name}"!`);
                    closeModal('adminModal');
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É
                    showGamePage(gameId);
                }
            };
            reader.readAsDataURL(uploadedFile);
        }

        // ====================== –ü–û–ö–£–ü–ö–ê ======================
        function processPurchase() {
            if (!currentUser || !selectedGame || !selectedDlc) return;

            if (currentUser.balance < selectedDlc.price) {
                showNotification('error', '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤');
                openDepositModal();
                return;
            }

            // –°–ø–∏—Å–∞–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
            currentUser.balance -= selectedDlc.price;
            localStorage.setItem('komet_user', JSON.stringify(currentUser));

            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞
            const key = generateKey();

            // –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–∫—É–ø–∫–∏
            const purchase = {
                id: Date.now(),
                userId: currentUser.id,
                gameId: selectedGame.id,
                gameName: selectedGame.name,
                dlcId: selectedDlc.id,
                dlcName: selectedDlc.name,
                price: selectedDlc.price,
                duration: selectedDlc.duration,
                key: key,
                fileUrl: selectedDlc.fileUrl,
                fileName: selectedDlc.fileName,
                date: new Date().toISOString()
            };

            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ–∫—É–ø–∫—É
            const purchases = JSON.parse(localStorage.getItem('komet_purchases')) || [];
            purchases.push(purchase);
            localStorage.setItem('komet_purchases', JSON.stringify(purchases));

            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            updateUI();
            closeModal('purchaseModal');
            
            showNotification('success', `
                ‚úÖ –ü–æ–∫—É–ø–∫–∞ —É—Å–ø–µ—à–Ω–∞!<br>
                üîë –ö–ª—é—á: ${key}<br>
                ${selectedDlc.fileUrl ? 'üì• –§–∞–π–ª –¥–æ—Å—Ç—É–ø–µ–Ω –≤ —Ä–∞–∑–¥–µ–ª–µ "–ö–ª—é—á–∏"' : '‚è≥ –§–∞–π–ª –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º'}
            `);
        }

        // ====================== –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø ======================
        function openAuthModal() {
            document.getElementById('authModal').classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        function login() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–¥–º–∏–Ω–∞
            if (email === ADMIN_EMAIL && password === ADMIN_PASSWORD) {
                currentUser = {
                    id: 1,
                    email: email,
                    username: 'Admin',
                    balance: 10000,
                    isAdmin: true
                };
            } 
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            else if (email.includes('@')) {
                currentUser = {
                    id: Date.now(),
                    email: email,
                    username: email.split('@')[0],
                    balance: 1000,
                    isAdmin: false
                };
            } else {
                showNotification('error', '–ù–µ–≤–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ');
                return;
            }

            localStorage.setItem('komet_user', JSON.stringify(currentUser));
            updateUI();
            closeModal('authModal');
            showNotification('success', '–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω');
        }

        function openDepositModal() {
            if (!currentUser) {
                openAuthModal();
                return;
            }
            document.getElementById('currentBalance').textContent = `${currentUser.balance} ‚ÇΩ`;
            document.getElementById('depositModal').classList.add('active');
        }

        function submitDeposit() {
            showNotification('info', '–ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞. –ü–æ—Å–ª–µ –ø–µ—Ä–µ–≤–æ–¥–∞ –ø—Ä–∏—à–ª–∏—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç –≤ Telegram.');
            closeModal('depositModal');
        }

        // ====================== –£–¢–ò–õ–ò–¢–´ ======================
        function updateUI() {
            if (currentUser?.isAdmin) {
                document.getElementById('adminPanel').style.display = 'block';
                document.querySelector('.bottom-nav').innerHTML += `
                    <a href="#" class="nav-item" onclick="openAdminModal()">
                        üëë –ê–¥–º–∏–Ω
                    </a>
                `;
            }
        }

        function generateKey() {
            const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789';
            let key = '';
            for (let i = 0; i < 16; i++) {
                if (i > 0 && i % 4 === 0) key += '-';
                key += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return key;
        }

        function copyKey(key) {
            navigator.clipboard.writeText(key)
                .then(() => showNotification('success', '–ö–ª—é—á —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω'));
        }

        function copyRefLink() {
            const link = `https://k0met.space/ref/${currentUser?.id || 'user'}`;
            navigator.clipboard.writeText(link)
                .then(() => showNotification('success', '–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞'));
        }

        function downloadFile(fileUrl, fileName) {
            if (!fileUrl) {
                showNotification('error', '–§–∞–π–ª –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º');
                return;
            }

            const link = document.createElement('a');
            link.href = fileUrl;
            link.download = fileName || 'file.bin';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function logout() {
            currentUser = null;
            localStorage.removeItem('komet_user');
            showPage('home');
            showNotification('success', '–í—ã –≤—ã—à–ª–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞');
        }

        function showNotification(type, html) {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.innerHTML = html;
            notification.style.borderLeftColor = 
                type === 'success' ? '#10b981' : 
                type === 'error' ? '#ef4444' : '#3b82f6';

            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 5000);
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª–æ–∫
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('modal')) {
                e.target.classList.remove('active');
            }
        });
    </script>
</body>
    </html>
