<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PrimeSpeak Academy</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        :root { 
            --primary: #4f46e5; --primary-dark: #3730a3; --secondary: #10b981; 
            --danger: #ef4444; --warning: #f59e0b; --light: #f8fafc; --dark: #1e293b; --gray: #64748b; 
        }
        [data-theme="dark"] {
            --light: #1e293b; --dark: #f8fafc; --gray: #94a3b8;
        }
        body { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 15px; color: var(--dark); transition: all 0.3s; }
        .login-container { max-width: 400px; margin: 50px auto; background: white; border-radius: 15px; box-shadow: 0 20px 60px rgba(0,0,0,0.1); padding: 30px; text-align: center; }
        .login-container h1 { color: var(--primary-dark); margin-bottom: 10px; }
        .login-container p { color: var(--gray); margin-bottom: 25px; }
        .login-tabs { display: flex; margin-bottom: 20px; border-radius: 10px; overflow: hidden; background: #f1f5f9; }
        .login-tab { flex: 1; padding: 12px; border: none; background: none; cursor: pointer; font-weight: 600; }
        .login-tab.active { background: var(--primary); color: white; }
        .login-input { width: 100%; padding: 15px; margin: 10px 0; border: 2px solid #e2e8f0; border-radius: 10px; font-size: 16px; }
        .login-input:focus { border-color: var(--primary); outline: none; }
        .login-btn { width: 100%; padding: 15px; background: var(--primary); color: white; border: none; border-radius: 10px; font-size: 16px; font-weight: 600; cursor: pointer; margin-top: 10px; }
        .login-btn:hover { background: var(--primary-dark); }
        .container { max-width: 100%; background: white; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); overflow: hidden; margin: 0 auto; display: none; }
        .header { background: linear-gradient(135deg, var(--primary), var(--primary-dark)); color: white; padding: 25px 15px; text-align: center; position: relative; }
        .user-info { position: absolute; top: 15px; right: 15px; background: rgba(255,255,255,0.2); padding: 8px 15px; border-radius: 20px; font-size: 0.9em; }
        .logout-btn { background: rgba(255,255,255,0.3); border: none; color: white; padding: 5px 10px; border-radius: 10px; cursor: pointer; margin-left: 10px; }
        .nav { display: flex; background: var(--primary-dark); flex-wrap: wrap; }
        .nav-btn { flex: 1; min-width: 80px; background: none; border: none; color: white; padding: 15px 10px; cursor: pointer; font-size: 12px; font-weight: 600; display: flex; flex-direction: column; align-items: center; gap: 5px; }
        .nav-btn.active { background: var(--primary); }
        .content { padding: 20px 15px; min-height: 500px; }
        .section { display: none; }
        .section.active { display: block; }
        .card { background: var(--light); border-radius: 12px; padding: 20px; margin-bottom: 15px; border-left: 4px solid var(--primary); }
        .student-card { display: flex; flex-direction: column; gap: 12px; }
        .student-info h3 { color: var(--primary-dark); margin-bottom: 6px; font-size: 1.2em; }
        .student-info p { color: var(--gray); margin: 2px 0; font-size: 0.9em; }
        .student-stats { display: flex; justify-content: space-between; align-items: center; }
        .average-grade { font-size: 1.5em; font-weight: bold; color: var(--primary); }
        .grade { display: inline-flex; align-items: center; justify-content: center; width: 35px; height: 35px; color: white; border-radius: 8px; font-weight: bold; margin: 2px; font-size: 0.9em; border: 2px solid transparent; }
        .grade-1, .grade-2, .grade-3 { background: #ef4444; }
        .grade-4, .grade-5, .grade-6 { background: #f59e0b; }
        .grade-7, .grade-8, .grade-9, .grade-10 { background: #10b981; }
        .grade-11, .grade-12, .grade-13, .grade-14, .grade-15 { background: #10b981; }
        .grade-16, .grade-17, .grade-18, .grade-19, .grade-20 { background: #10b981; }
        .grade-21, .grade-22, .grade-23, .grade-24, .grade-25 { background: #10b981; }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 6px; font-weight: 600; color: var(--dark); font-size: 0.9em; }
        .input, .select { width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; }
        .input:focus, .select:focus { border-color: var(--primary); outline: none; }
        .btn { background: var(--primary); color: white; border: none; padding: 12px 20px; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 600; width: 100%; margin-top: 10px; }
        .btn:hover { background: var(--primary-dark); }
        .btn-success { background: var(--secondary); }
        .btn-success:hover { background: #0da271; }
        .btn-danger { background: var(--danger); }
        .btn-danger:hover { background: #dc2626; }
        .btn-warning { background: var(--warning); }
        .btn-warning:hover { background: #d97706; }
        .stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin: 20px 0; }
        .stat-card { background: white; padding: 15px; border-radius: 10px; text-align: center; box-shadow: 0 3px 10px rgba(0,0,0,0.08); border-top: 4px solid var(--primary); }
        .stat-number { font-size: 1.8em; font-weight: bold; color: var(--primary); margin: 5px 0; }
        .stat-label { color: var(--gray); font-size: 0.8em; }
        .empty-state { text-align: center; padding: 40px 15px; color: var(--gray); }
        h2 { margin-bottom: 15px; color: var(--primary-dark); font-size: 1.3em; }
        h3 { margin-bottom: 10px; color: var(--dark); font-size: 1.1em; }
        .student-grades-list { margin-top: 20px; }
        .grade-item { display: flex; justify-content: space-between; align-items: center; padding: 15px; border-bottom: 1px solid #e2e8f0; }
        .grade-item:last-child { border-bottom: none; }
        .login-info { background: #f0f9ff; border: 2px solid #0ea5e9; border-radius: 10px; padding: 15px; margin: 10px 0; }
        .grade-type-tabs { display: flex; margin-bottom: 15px; border-radius: 8px; overflow: hidden; background: #f1f5f9; }
        .grade-type-tab { flex: 1; padding: 10px; border: none; background: none; cursor: pointer; font-weight: 600; font-size: 12px; }
        .grade-type-tab.active { background: var(--primary); color: white; }
        .save-btn { background: var(--secondary); margin-top: 5px; }
        .save-btn:hover { background: #0da271; }
        
        /* –ù–û–í–´–ï –°–¢–ò–õ–ò –î–õ–Ø –í–°–ï–• –§–ò–ß */
        .charts-grid { display: grid; grid-template-columns: 1fr; gap: 20px; margin: 20px 0; }
        .chart-container { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 3px 15px rgba(0,0,0,0.1); }
        .calendar { display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; margin: 15px 0; }
        .calendar-day { padding: 10px; text-align: center; border-radius: 8px; background: #f1f5f9; cursor: pointer; }
        .calendar-day.has-grade { background: var(--primary); color: white; }
        .badge { display: inline-block; padding: 4px 8px; background: var(--warning); color: white; border-radius: 12px; font-size: 0.7em; margin: 2px; }
        .notification { padding: 12px; background: #fef3cd; border-left: 4px solid var(--warning); margin: 10px 0; border-radius: 8px; }
        .chat-container { max-height: 300px; overflow-y: auto; border: 1px solid #e2e8f0; border-radius: 10px; padding: 15px; }
        .message { margin: 10px 0; padding: 10px; border-radius: 10px; max-width: 80%; }
        .message.teacher { background: #dbeafe; margin-left: auto; }
        .message.student { background: #f1f5f9; }
        .theme-toggle { position: fixed; bottom: 20px; right: 20px; background: var(--primary); color: white; border: none; padding: 12px; border-radius: 50%; cursor: pointer; box-shadow: 0 4px 12px rgba(0,0,0,0.2); }
        .achievement { display: flex; align-items: center; gap: 12px; padding: 12px; background: white; border-radius: 10px; margin: 8px 0; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .achievement-icon { font-size: 1.5em; }
        .schedule-item { padding: 12px; background: white; border-radius: 10px; margin: 8px 0; border-left: 4px solid var(--primary); }
        .deadline { color: var(--danger); font-weight: bold; }
        @media (min-width: 768px) {
            .charts-grid { grid-template-columns: 1fr 1fr; }
            .stats-grid { grid-template-columns: repeat(4, 1fr); }
        }
    </style>
</head>
<body>
    <div class="login-container" id="loginScreen">
        <h1>üìö PrimeSpeak Academy</h1>
        <p>–í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É</p>
        
        <div class="login-tabs">
            <button class="login-tab active" onclick="showLoginTab('teacher')">üë®‚Äçüè´ –£—á–∏—Ç–µ–ª—å</button>
            <button class="login-tab" onclick="showLoginTab('student')">üë®‚Äçüéì –£—á–µ–Ω–∏–∫</button>
        </div>

        <div id="teacherLogin">
            <input type="text" class="login-input" id="teacherEmail" placeholder="Email —É—á–∏—Ç–µ–ª—è">
            <input type="password" class="login-input" id="teacherPassword" placeholder="–ü–∞—Ä–æ–ª—å —É—á–∏—Ç–µ–ª—è">
            <button class="login-btn" onclick="loginTeacher()">–í–æ–π—Ç–∏ –∫–∞–∫ —É—á–∏—Ç–µ–ª—å</button>
            <button class="login-btn save-btn" onclick="saveLoginData('teacher')">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤—Ö–æ–¥–∞</button>
        </div>

        <div id="studentLogin" style="display: none;">
            <input type="text" class="login-input" id="studentLoginInput" placeholder="–õ–æ–≥–∏–Ω —É—á–µ–Ω–∏–∫–∞">
            <input type="password" class="login-input" id="studentPassword" placeholder="–ü–∞—Ä–æ–ª—å —É—á–µ–Ω–∏–∫–∞">
            <button class="login-btn" onclick="loginStudent()">–í–æ–π—Ç–∏ –∫–∞–∫ —É—á–µ–Ω–∏–∫</button>
            <button class="login-btn save-btn" onclick="saveLoginData('student')">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤—Ö–æ–¥–∞</button>
        </div>

        <button onclick="testConnection()" style="margin-top: 20px; padding: 10px; background: #10b981; color: white; border: none; border-radius: 5px; cursor: pointer; width: 100%;">
            üß™ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
        </button>
    </div>

    <div class="container" id="mainApp">
        <div class="header" id="teacherHeader">
            <div class="user-info">
                üë®‚Äçüè´ <span id="userName">Jasur Sheraliev</span>
                <button class="logout-btn" onclick="logout()">üö™</button>
            </div>
            <h1>üìö English Grades Journal</h1>
            <div class="company-name">PrimeSpeak Academy</div>
            <p>10-–±–∞–ª–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ ‚Ä¢ Teacher Portal</p>
        </div>

        <div class="header" id="studentHeader" style="display: none;">
            <div class="user-info">
                üë®‚Äçüéì <span id="studentNameDisplay">–£—á–µ–Ω–∏–∫</span>
                <button class="logout-btn" onclick="logout()">üö™</button>
            </div>
            <h1>üìö –ú–æ–∏ –æ—Ü–µ–Ω–∫–∏</h1>
            <div class="company-name">PrimeSpeak Academy</div>
            <p>10-–±–∞–ª–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ ‚Ä¢ Student Portal</p>
        </div>

        <div class="nav" id="teacherNav">
            <button class="nav-btn active" onclick="showSection('dashboard')">üìä<span>–î–∞—à–±–æ—Ä–¥</span></button>
            <button class="nav-btn" onclick="showSection('students')">üë®‚Äçüéì<span>–£—á–µ–Ω–∏–∫–∏</span></button>
            <button class="nav-btn" onclick="showSection('addStudent')">‚ûï<span>–î–æ–±–∞–≤–∏—Ç—å</span></button>
            <button class="nav-btn" onclick="showSection('grades')">üìù<span>–û—Ü–µ–Ω–∫–∏</span></button>
            <button class="nav-btn" onclick="showSection('analytics')">üìà<span>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</span></button>
            <button class="nav-btn" onclick="showSection('schedule')">üìÖ<span>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</span></button>
        </div>

        <div class="content">
            <!-- –û–°–ù–û–í–ù–´–ï –°–ï–ö–¶–ò–ò -->
            <div id="dashboard" class="section active">
                <h2>üìä –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
                <div class="stats-grid">
                    <div class="stat-card"><div>üë®‚Äçüéì</div><div class="stat-number" id="totalStudents">0</div><div class="stat-label">–£—á–µ–Ω–∏–∫–æ–≤</div></div>
                    <div class="stat-card"><div>‚≠ê</div><div class="stat-number" id="averageGrade">0.0</div><div class="stat-label">–°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª</div></div>
                    <div class="stat-card"><div>üìù</div><div class="stat-number" id="totalGrades">0</div><div class="stat-label">–û—Ü–µ–Ω–æ–∫</div></div>
                    <div class="stat-card"><div>üìö</div><div class="stat-number">2</div><div class="stat-label">–ö—É—Ä—Å–∞</div></div>
                </div>
                
                <div class="card">
                    <h3>üîî –ü–æ—Å–ª–µ–¥–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h3>
                    <div id="notificationsList"></div>
                </div>
                
                <div class="card"><h3>üìà –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ—Ü–µ–Ω–∫–∏</h3><div id="recentGrades"></div></div>
            </div>

            <div id="students" class="section">
                <h2>üë®‚Äçüéì –°–ø–∏—Å–æ–∫ —É—á–µ–Ω–∏–∫–æ–≤</h2>
                <div id="studentsList"></div>
            </div>

            <div id="addStudent" class="section">
                <h2>‚ûï –î–æ–±–∞–≤–∏—Ç—å —É—á–µ–Ω–∏–∫–∞</h2>
                <div class="card">
                    <div class="form-group">
                        <label>üë§ –ü–æ–ª–Ω–æ–µ –∏–º—è —É—á–µ–Ω–∏–∫–∞</label>
                        <input type="text" class="input" id="studentName" placeholder="–ò–º—è –∏ —Ñ–∞–º–∏–ª–∏—è">
                    </div>
                    <div class="form-group">
                        <label>üë§ –õ–æ–≥–∏–Ω –¥–ª—è –≤—Ö–æ–¥–∞</label>
                        <input type="text" class="input" id="studentUsername" placeholder="–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –ª–æ–≥–∏–Ω">
                    </div>
                    <div class="form-group">
                        <label>üîë –ü–∞—Ä–æ–ª—å –¥–ª—è –≤—Ö–æ–¥–∞</label>
                        <input type="text" class="input" id="studentPasswordInput" placeholder="–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å">
                    </div>
                    <div class="form-group">
                        <label>üìß Email —É—á–µ–Ω–∏–∫–∞</label>
                        <input type="email" class="input" id="studentEmail" placeholder="example@gmail.com">
                    </div>
                    <div class="form-group">
                        <label>üìö –ö—É—Ä—Å</label>
                        <select class="select" id="studentCourse">
                            <option value="basic">–ù–∞—á–∞–ª—å–Ω—ã–π –∞–Ω–≥–ª–∏–π—Å–∫–∏–π</option>
                            <option value="advanced">–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –∞–Ω–≥–ª–∏–π—Å–∫–∏–π</option>
                        </select>
                    </div>
                    <button class="btn" onclick="addStudent()">‚úÖ –î–æ–±–∞–≤–∏—Ç—å —É—á–µ–Ω–∏–∫–∞</button>
                    <button class="btn save-btn" onclick="saveStudentForm()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–æ—Ä–º—É</button>
                </div>
            </div>

            <div id="grades" class="section">
                <h2>üìù –í—ã—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ—Ü–µ–Ω–æ–∫</h2>
                <div class="card">
                    <div class="form-group">
                        <label>üë®‚Äçüéì –í—ã–±–µ—Ä–∏—Ç–µ —É—á–µ–Ω–∏–∫–∞</label>
                        <select class="select" id="gradeStudent"></select>
                    </div>
                    
                    <div class="grade-type-tabs">
                        <button class="grade-type-tab active" onclick="showGradeType('regular')">üìö –û–±—ã—á–Ω—ã–µ (10 –±–∞–ª–ª–æ–≤)</button>
                        <button class="grade-type-tab" onclick="showGradeType('test')">üéì –¢–µ—Å—Ç—ã (25 –±–∞–ª–ª–æ–≤)</button>
                    </div>

                    <div id="regularGrades" class="grade-type-content">
                        <div class="form-group">
                            <label>‚≠ê –û—Ü–µ–Ω–∫–∞ (10-–±–∞–ª–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞)</label>
                            <select class="select" id="gradeValue">
                                <option value="1">1 - –û—á–µ–Ω—å –ø–ª–æ—Ö–æ</option>
                                <option value="2">2 - –ü–ª–æ—Ö–æ</option>
                                <option value="3">3 - –ù–µ—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ</option>
                                <option value="4">4 - –ù–∏–∂–µ —Å—Ä–µ–¥–Ω–µ–≥–æ</option>
                                <option value="5">5 - –£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ</option>
                                <option value="6">6 - –•–æ—Ä–æ—à–æ</option>
                                <option value="7">7 - –û—á–µ–Ω—å —Ö–æ—Ä–æ—à–æ</option>
                                <option value="8">8 - –û—Ç–ª–∏—á–Ω–æ</option>
                                <option value="9">9 - –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ</option>
                                <option value="10">10 - –ë–ª–µ—Å—Ç—è—â–µ</option>
                            </select>
                        </div>
                    </div>

                    <div id="testGrades" class="grade-type-content" style="display: none;">
                        <div class="form-group">
                            <label>üéì –û—Ü–µ–Ω–∫–∞ –∑–∞ —Ç–µ—Å—Ç (25-–±–∞–ª–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞)</label>
                            <select class="select" id="testGradeValue">
                                <option value="1">1 –±–∞–ª–ª</option><option value="2">2 –±–∞–ª–ª–∞</option><option value="3">3 –±–∞–ª–ª–∞</option>
                                <option value="4">4 –±–∞–ª–ª–∞</option><option value="5">5 –±–∞–ª–ª–æ–≤</option><option value="6">6 –±–∞–ª–ª–æ–≤</option>
                                <option value="7">7 –±–∞–ª–ª–æ–≤</option><option value="8">8 –±–∞–ª–ª–æ–≤</option><option value="9">9 –±–∞–ª–ª–æ–≤</option>
                                <option value="10">10 –±–∞–ª–ª–æ–≤</option><option value="11">11 –±–∞–ª–ª–æ–≤</option><option value="12">12 –±–∞–ª–ª–æ–≤</option>
                                <option value="13">13 –±–∞–ª–ª–æ–≤</option><option value="14">14 –±–∞–ª–ª–æ–≤</option><option value="15">15 –±–∞–ª–ª–æ–≤</option>
                                <option value="16">16 –±–∞–ª–ª–æ–≤</option><option value="17">17 –±–∞–ª–ª–æ–≤</option><option value="18">18 –±–∞–ª–ª–æ–≤</option>
                                <option value="19">19 –±–∞–ª–ª–æ–≤</option><option value="20">20 –±–∞–ª–ª–æ–≤</option><option value="21">21 –±–∞–ª–ª</option>
                                <option value="22">22 –±–∞–ª–ª–∞</option><option value="23">23 –±–∞–ª–ª–∞</option><option value="24">24 –±–∞–ª–ª–∞</option>
                                <option value="25">25 –±–∞–ª–ª–æ–≤</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>üìÑ –ó–∞–¥–∞–Ω–∏–µ/–¢–µ–º–∞ —É—Ä–æ–∫–∞</label>
                        <input type="text" class="input" id="gradeAssignment" placeholder="Present Simple, Homework #5">
                    </div>
                    <button class="btn" onclick="addGrade()">üìù –ü–æ—Å—Ç–∞–≤–∏—Ç—å –æ—Ü–µ–Ω–∫—É</button>
                    <button class="btn save-btn" onclick="saveGradeForm()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–æ—Ä–º—É</button>
                </div>
                <div class="card"><h3>üìã –ò—Å—Ç–æ—Ä–∏—è –æ—Ü–µ–Ω–æ–∫</h3><div id="gradesHistory"></div></div>
            </div>

            <!-- –ù–û–í–´–ï –°–ï–ö–¶–ò–ò –° –í–°–ï–ú–ò –§–ò–ß–ê–ú–ò -->
            <div id="analytics" class="section">
                <h2>üìà –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –≥—Ä–∞—Ñ–∏–∫–∏</h2>
                <div class="charts-grid">
                    <div class="chart-container">
                        <h3>üìä –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Ü–µ–Ω–æ–∫</h3>
                        <canvas id="gradesDistributionChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <h3>üìà –î–∏–Ω–∞–º–∏–∫–∞ —É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç–∏</h3>
                        <canvas id="progressChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <h3>üéØ –°—Ä–µ–¥–Ω–∏–µ –±–∞–ª–ª—ã –ø–æ —É—á–µ–Ω–∏–∫–∞–º</h3>
                        <canvas id="studentsChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <h3>üìÖ –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ –¥–Ω—è–º</h3>
                        <canvas id="activityChart"></canvas>
                    </div>
                </div>
            </div>

            <div id="schedule" class="section">
                <h2>üìÖ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∏ –¥–µ–¥–ª–∞–π–Ω—ã</h2>
                <div class="card">
                    <h3>üóìÔ∏è –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞–Ω—è—Ç–∏–π</h3>
                    <div class="calendar" id="calendar"></div>
                </div>
                <div class="card">
                    <h3>‚è∞ –ë–ª–∏–∂–∞–π—à–∏–µ –¥–µ–¥–ª–∞–π–Ω—ã</h3>
                    <div id="deadlinesList"></div>
                </div>
                <div class="card">
                    <h3>‚ûï –î–æ–±–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ</h3>
                    <div class="form-group">
                        <label>üìù –û–ø–∏—Å–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è</label>
                        <input type="text" class="input" id="eventTitle" placeholder="–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞, –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ">
                    </div>
                    <div class="form-group">
                        <label>üìÖ –î–∞—Ç–∞</label>
                        <input type="date" class="input" id="eventDate">
                    </div>
                    <div class="form-group">
                        <label>üë®‚Äçüéì –î–ª—è —É—á–µ–Ω–∏–∫–∞ (–∏–ª–∏ –≤—Å–µ—Ö)</label>
                        <select class="select" id="eventStudent">
                            <option value="all">–í—Å–µ —É—á–µ–Ω–∏–∫–∏</option>
                        </select>
                    </div>
                    <button class="btn" onclick="addEvent()">‚úÖ –î–æ–±–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ</button>
                </div>
            </div>

            <div id="studentGrades" class="section">
                <h2>üìä –ú–æ–∏ –æ—Ü–µ–Ω–∫–∏ –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h2>
                <div class="card">
                    <h3>üëã –ü—Ä–∏–≤–µ—Ç, <span id="welcomeStudentName">–£—á–µ–Ω–∏–∫</span>!</h3>
                    <p><strong>–¢–≤–æ–π —Å—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª:</strong> <span id="studentAverageGrade" style="font-size: 1.5em; color: var(--primary);">0.0</span></p>
                    <p><strong>–ö—É—Ä—Å:</strong> <span id="studentCourseDisplay">-</span></p>
                    <p><strong>–ó–∞—á–∏—Å–ª–µ–Ω:</strong> <span id="studentJoinDate">-</span></p>
                </div>
                
                <div class="card">
                    <h3>üèÜ –ú–æ–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h3>
                    <div id="studentAchievements"></div>
                </div>
                
                <div class="card">
                    <h3>üìà –ú–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å</h3>
                    <canvas id="studentProgressChart"></canvas>
                </div>
                
                <div class="card">
                    <h3>üìù –ò—Å—Ç–æ—Ä–∏—è –º–æ–∏—Ö –æ—Ü–µ–Ω–æ–∫</h3>
                    <div class="student-grades-list" id="studentGradesList"></div>
                </div>
                
                <div class="card">
                    <h3>üí¨ –ß–∞—Ç —Å —É—á–∏—Ç–µ–ª–µ–º</h3>
                    <div class="chat-container" id="chatMessages"></div>
                    <div class="form-group">
                        <input type="text" class="input" id="chatMessage" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...">
                        <button class="btn" onclick="sendMessage()">üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <button class="theme-toggle" onclick="toggleTheme()">üåô</button>

    <script>
        // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø SUPABASE
        const supabaseUrl = 'https://kgkkdjujxruiakbglnop.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imtna2tkanVqeHJ1aWFrYmdsbm9wIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMyNzI0MDMsImV4cCI6MjA3ODg0ODQwM30.R8vESEB3T-wqPlsykf4YnKm3wawuu70Xeph4GUCigsM';
        const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);

        let currentUser = null;
        let currentGradeType = 'regular';
        let charts = {};

        // –¢–ï–ú–ù–ê–Ø –¢–ï–ú–ê
        function toggleTheme() {
            document.body.setAttribute('data-theme', 
                document.body.getAttribute('data-theme') === 'dark' ? 'light' : 'dark'
            );
        }

        // –í–°–ï –û–°–¢–ê–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò –û–°–¢–ê–Æ–¢–°–Ø –¢–ê–ö–ò–ú–ò –ñ–ï –ö–ê–ö –í –ü–†–ï–î–´–î–£–©–ï–ô –í–ï–†–°–ò–ò
        // (login, logout, addStudent, addGrade, etc.)

        // –ù–û–í–´–ï –§–£–ù–ö–¶–ò–ò –î–õ–Ø –í–°–ï–• –§–ò–ß
        async function loadAnalytics() {
            const { data: grades } = await supabase.from('grades').select('*');
            const { data: students } = await supabase.from('students').select('*');
            
            // –ì—Ä–∞—Ñ–∏–∫ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ—Ü–µ–Ω–æ–∫
            const gradeCounts = {1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0};
            grades.forEach(grade => gradeCounts[grade.grade]++);
            
            if (charts.gradesDistribution) charts.gradesDistribution.destroy();
            charts.gradesDistribution = new Chart(document.getElementById('gradesDistributionChart'), {
                type: 'bar',
                data: {
                    labels: Object.keys(gradeCounts),
                    datasets: [{
                        label: '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ü–µ–Ω–æ–∫',
                        data: Object.values(gradeCounts),
                        backgroundColor: '#4f46e5'
                    }]
                }
            });

            // –î—Ä—É–≥–∏–µ –≥—Ä–∞—Ñ–∏–∫–∏...
        }

        async function loadSchedule() {
            const today = new Date();
            const calendar = document.getElementById('calendar');
            calendar.innerHTML = '';
            
            // –ü—Ä–æ—Å—Ç–æ–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å –Ω–∞ —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü
            for (let i = 1; i <= 31; i++) {
                const day = document.createElement('div');
                day.className = 'calendar-day';
                day.textContent = i;
                calendar.appendChild(day);
            }
        }

        async function loadAchievements() {
            const achievements = [
                { icon: '‚≠ê', title: '–ü–µ—Ä–≤–∞—è –ø—è—Ç–µ—Ä–∫–∞', description: '–ü–æ–ª—É—á–∏–ª –ø–µ—Ä–≤—É—é –æ—Ü–µ–Ω–∫—É 5' },
                { icon: 'üìö', title: '–ê–∫—Ç–∏–≤–Ω—ã–π —É—á–µ–Ω–∏–∫', description: '10+ –æ—Ü–µ–Ω–æ–∫ –∑–∞ –º–µ—Å—è—Ü' },
                { icon: 'üöÄ', title: '–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç', description: '–°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª –≤—ã—à–µ 8.0' }
            ];
            
            const container = document.getElementById('studentAchievements');
            container.innerHTML = achievements.map(ach => `
                <div class="achievement">
                    <div class="achievement-icon">${ach.icon}</div>
                    <div>
                        <strong>${ach.title}</strong>
                        <div style="color: var(--gray); font-size: 0.9em;">${ach.description}</div>
                    </div>
                </div>
            `).join('');
        }

        async function sendMessage() {
            const message = document.getElementById('chatMessage').value;
            if (!message) return;
            
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã —Å–æ—Ö—Ä–∞–Ω—è–ª–æ—Å—å –≤ –±–∞–∑—É
            const chat = document.getElementById('chatMessages');
            chat.innerHTML += `<div class="message student"><strong>–í—ã:</strong> ${message}</div>`;
            document.getElementById('chatMessage').value = '';
            chat.scrollTop = chat.scrollHeight;
        }

        // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –í–°–ï–• –§–ò–ß –ü–†–ò –ó–ê–ì–†–£–ó–ö–ï
        async function loadTeacherData() {
            await loadStudents();
            await loadGradeStudentSelect();
            await loadGradesHistory();
            await updateDashboard();
            await loadAnalytics();
            await loadSchedule();
            await loadAchievements();
        }

        // –û–°–¢–ê–õ–¨–ù–û–ô –ö–û–î –û–°–¢–ê–ï–¢–°–Ø –ü–†–ï–ñ–ù–ò–ú...
        // (–≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏)

    </script>
</body>
</html>
